<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Paulo Inácio Prado" />


<title>RRR: Reproduzindo o Resampling com Rsampling</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css;charset=utf-8,body%7Bbackground%2Dcolor%3A%23fff%3Bmargin%3A1em%20auto%3Bmax%2Dwidth%3A700px%3Boverflow%3Avisible%3Bpadding%2Dleft%3A2em%3Bpadding%2Dright%3A2em%3Bfont%2Dfamily%3A%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3Bfont%2Dsize%3A14px%3Bline%2Dheight%3A1%2E35%7D%23header%7Btext%2Dalign%3Acenter%7D%23TOC%7Bclear%3Aboth%3Bmargin%3A0%200%2010px%2010px%3Bpadding%3A4px%3Bwidth%3A400px%3Bborder%3A1px%20solid%20%23CCCCCC%3Bborder%2Dradius%3A5px%3Bbackground%2Dcolor%3A%23f6f6f6%3Bfont%2Dsize%3A13px%3Bline%2Dheight%3A1%2E3%7D%23TOC%20%2Etoctitle%7Bfont%2Dweight%3Abold%3Bfont%2Dsize%3A15px%3Bmargin%2Dleft%3A5px%7D%23TOC%20ul%7Bpadding%2Dleft%3A40px%3Bmargin%2Dleft%3A%2D1%2E5em%3Bmargin%2Dtop%3A5px%3Bmargin%2Dbottom%3A5px%7D%23TOC%20ul%20ul%7Bmargin%2Dleft%3A%2D2em%7D%23TOC%20li%7Bline%2Dheight%3A16px%7Dtable%7Bmargin%3A1em%20auto%3Bborder%2Dwidth%3A1px%3Bborder%2Dcolor%3A%23DDDDDD%3Bborder%2Dstyle%3Aoutset%3Bborder%2Dcollapse%3Acollapse%7Dtable%20th%7Bborder%2Dwidth%3A2px%3Bpadding%3A5px%3Bborder%2Dstyle%3Ainset%7Dtable%20td%7Bborder%2Dwidth%3A1px%3Bborder%2Dstyle%3Ainset%3Bline%2Dheight%3A18px%3Bpadding%3A5px%205px%7Dtable%2C%20table%20th%2C%20table%20td%7Bborder%2Dleft%2Dstyle%3Anone%3Bborder%2Dright%2Dstyle%3Anone%7Dtable%20thead%2C%20table%20tr%2Eeven%7Bbackground%2Dcolor%3A%23f7f7f7%7Dp%7Bmargin%3A0%2E5em%200%7Dblockquote%7Bbackground%2Dcolor%3A%23f6f6f6%3Bpadding%3A0%2E25em%200%2E75em%7Dhr%7Bborder%2Dstyle%3Asolid%3Bborder%3Anone%3Bborder%2Dtop%3A1px%20solid%20%23777%3Bmargin%3A28px%200%7Ddl%7Bmargin%2Dleft%3A0%7Ddl%20dd%7Bmargin%2Dbottom%3A13px%3Bmargin%2Dleft%3A13px%7Ddl%20dt%7Bfont%2Dweight%3Abold%7Dul%7Bmargin%2Dtop%3A0%7Dul%20li%7Blist%2Dstyle%3Acircle%20outside%7Dul%20ul%7Bmargin%2Dbottom%3A0%7Dpre%2C%20code%7Bbackground%2Dcolor%3A%23f7f7f7%3Bborder%2Dradius%3A3px%3Bcolor%3A%23333%7Dpre%7Bwhite%2Dspace%3Apre%2Dwrap%3Bborder%2Dradius%3A3px%3Bmargin%3A5px%200px%2010px%200px%3Bpadding%3A10px%7Dpre%3Anot%28%5Bclass%5D%29%7Bbackground%2Dcolor%3A%23f7f7f7%7Dcode%7Bfont%2Dfamily%3AConsolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3Bfont%2Dsize%3A85%25%7Dp%20%3E%20code%2C%20li%20%3E%20code%7Bpadding%3A2px%200px%7Ddiv%2Efigure%7Btext%2Dalign%3Acenter%7Dimg%7Bbackground%2Dcolor%3A%23FFFFFF%3Bpadding%3A2px%3Bborder%3A1px%20solid%20%23DDDDDD%3Bborder%2Dradius%3A3px%3Bborder%3A1px%20solid%20%23CCCCCC%3Bmargin%3A0%205px%7Dh1%7Bmargin%2Dtop%3A0%3Bfont%2Dsize%3A35px%3Bline%2Dheight%3A40px%7Dh2%7Bborder%2Dbottom%3A4px%20solid%20%23f7f7f7%3Bpadding%2Dtop%3A10px%3Bpadding%2Dbottom%3A2px%3Bfont%2Dsize%3A145%25%7Dh3%7Bborder%2Dbottom%3A2px%20solid%20%23f7f7f7%3Bpadding%2Dtop%3A10px%3Bfont%2Dsize%3A120%25%7Dh4%7Bborder%2Dbottom%3A1px%20solid%20%23f7f7f7%3Bmargin%2Dleft%3A8px%3Bfont%2Dsize%3A105%25%7Dh5%2C%20h6%7Bborder%2Dbottom%3A1px%20solid%20%23ccc%3Bfont%2Dsize%3A105%25%7Da%7Bcolor%3A%230033dd%3Btext%2Ddecoration%3Anone%7Da%3Ahover%7Bcolor%3A%236666ff%7Da%3Avisited%7Bcolor%3A%23800080%7Da%3Avisited%3Ahover%7Bcolor%3A%23BB00BB%7Da%5Bhref%5E%3D%22http%3A%22%5D%7Btext%2Ddecoration%3Aunderline%7Da%5Bhref%5E%3D%22https%3A%22%5D%7Btext%2Ddecoration%3Aunderline%7Dcode%20%3E%20span%2Ekw%7Bcolor%3A%23555%3Bfont%2Dweight%3Abold%7Dcode%20%3E%20span%2Edt%7Bcolor%3A%23902000%7Dcode%20%3E%20span%2Edv%7Bcolor%3A%2340a070%7Dcode%20%3E%20span%2Ebn%7Bcolor%3A%23d14%7Dcode%20%3E%20span%2Efl%7Bcolor%3A%23d14%7Dcode%20%3E%20span%2Ech%7Bcolor%3A%23d14%7Dcode%20%3E%20span%2Est%7Bcolor%3A%23d14%7Dcode%20%3E%20span%2Eco%7Bcolor%3A%23888888%3Bfont%2Dstyle%3Aitalic%7Dcode%20%3E%20span%2Eot%7Bcolor%3A%23007020%7Dcode%20%3E%20span%2Eal%7Bcolor%3A%23ff0000%3Bfont%2Dweight%3Abold%7Dcode%20%3E%20span%2Efu%7Bcolor%3A%23900%3Bfont%2Dweight%3Abold%7Dcode%20%3E%20span%2Eer%7Bcolor%3A%23a61717%3Bbackground%2Dcolor%3A%23e3d2d2%7D" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">RRR: Reproduzindo o Resampling com Rsampling</h1>
<h4 class="author"><em>Paulo Inácio Prado</em></h4>
<h4 class="date"><em>Junho de 2015</em></h4>
</div>


<div id="apresentacao" class="section level2">
<h2>Apresentação</h2>
<p>Este roteiro é uma introdução ao pacote <strong>Rsampling</strong>, que reproduz em R as funções do programa <em>Resampling Stats</em> (<a href="http://www.resample.com/" class="uri">http://www.resample.com/</a>).</p>
<p>Essas funções são usadas em um ciclo de trabalho que resume a lógica dos testes de significância:</p>
<ol style="list-style-type: decimal">
<li>Defina uma estatística de interesse;</li>
<li>Defina a hipótese nula;</li>
<li>Obtenha a distribuição da estatística de interesse sob a hipótese nula;</li>
<li>Se a probabilidade da estatística de interesse observada ocorrer sob a hipótese nula é menor do que um valor crítico rejeite a hipótese nula.</li>
</ol>
<p>A ideia do <em>Resampling Stats</em> é facilitar o entendimento dessa lógica, fazendo o usuário executar cada um dos passos em um planilha, com o auxílio de algumas macros. Um elemento muito efetivo para este aprendizado é que a hipótese nula é simulada por aleatorização dos dados. Isso também dá muita flexibilidade aos testes que podem ser feitos. O manual do <em>Resampling Stats</em> é uma excelente introdução a esta metodologia, e à lógica dos testes de significância <a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>.</p>
<p>O objetivo do pacote <strong>Rsampling</strong> é possibilitar este mesmo treinamento no R. Assim, privilegiamos fidelidade à lógica original e à didática em eventual detrimento de desempenho computacional.</p>
<p>As seções após instruções de instalação são exemplos de uso mais simples e comuns do <strong>Rsampling</strong>. Consulte também as páginas de ajuda do pacote para conhecer todas as funcionalidades.</p>
</div>
<div id="instalacao" class="section level2">
<h2>Instalação</h2>
<p>O pacote <strong>Rsampling</strong> está hospedado no GitHub. Para instalá-lo use a função <code>install_github</code> do pacote devtools:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">library</span>(devtools)
&gt;<span class="st"> </span><span class="kw">install_github</span>(<span class="dt">repo =</span> <span class="st">'lageIBUSP/Rsampling'</span>)</code></pre></div>
<p>E então carregue com</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">library</span>(Rsampling)</code></pre></div>
</div>
<div id="embaralhando-dentro-de-uma-coluna-para-testar-diferenca-entre-grupos" class="section level2">
<h2>Embaralhando dentro de uma coluna para testar diferença entre grupos</h2>
<p>O dataframe <code>embauba</code> tem os dados de presença e ausência de lianas em embaúbas de dois morfotipos (brancas e vermelhas).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">head</span>(embauba)
  morphotype with.vines
<span class="dv">1</span>   VERMELHA      <span class="ot">FALSE</span>
<span class="dv">2</span>   VERMELHA      <span class="ot">FALSE</span>
<span class="dv">3</span>   VERMELHA      <span class="ot">FALSE</span>
<span class="dv">4</span>   VERMELHA      <span class="ot">FALSE</span>
<span class="dv">5</span>   VERMELHA      <span class="ot">FALSE</span>
<span class="dv">6</span>   VERMELHA      <span class="ot">FALSE</span>
&gt;<span class="st"> </span><span class="kw">summary</span>(embauba)
    morphotype with.vines     
 BRANCA  :<span class="dv">82</span>   Mode :logical  
 VERMELHA:<span class="dv">70</span>   <span class="ot">FALSE</span>:<span class="dv">105</span>      
               <span class="ot">TRUE</span> :<span class="dv">47</span>       
               NA<span class="st">'s :0        </span></code></pre></div>
<p>Para mais detalhes sobre os dados e o estudo que os produziu consulte a página de ajuda (<code>?embauba</code>).</p>
<div id="hipotese-do-estudo" class="section level3">
<h3>Hipótese do estudo</h3>
<p>A hipótese deste estudo é que as formigas removem lianas das embaúbas onde estão suas colônias. A previsão é que embaúbas vermelhas seriam menos infestadas por lianas do que as brancas, por abrigarem colônias de formigas mais frequentemente. De fato, esta diferença é observada nas proporções de árvores infestadas na amostra:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">tapply</span>(embauba$with.vines, embauba$morphotype, mean)
   BRANCA  VERMELHA 
<span class="fl">0.4878049</span> <span class="fl">0.1000000</span> </code></pre></div>
</div>
<div id="hipotese-nula" class="section level3">
<h3>Hipótese nula</h3>
<p>A hipótese nula é de que as proporções de infestação são iguais na população de onde vieram as amostras. Sob esta hipótese, uma liana tem a mesma chance de estar em uma embaúba branca ou vermelha. Simulamos a hipótese nula embaralhando as presenças de lianas entre plantas na tabela de dados.</p>
</div>
<div id="estatistica-de-interesse" class="section level3">
<h3>Estatística de interesse</h3>
<p>A cada simulação temos que calcular nossa <strong>estatística de interesse</strong>, que é a a diferença de infestação entre os dois morfos. Criamos uma função para isso:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>emb.ei &lt;-<span class="st"> </span>function(dataframe){
+<span class="st">     </span>props &lt;-<span class="st"> </span><span class="kw">tapply</span>(dataframe$with.vines, dataframe$morphotype, mean)
+<span class="st">     </span>props[[<span class="dv">1</span>]] -<span class="st"> </span>props[[<span class="dv">2</span>]]
+<span class="st"> </span>}
&gt;<span class="st"> </span>## Verificando
<span class="er">&gt;</span><span class="st"> </span><span class="kw">emb.ei</span>(embauba)
[<span class="dv">1</span>] <span class="fl">0.3878049</span></code></pre></div>
</div>
<div id="distribuicao-da-estatistica-sob-a-hipotese-nula" class="section level3">
<h3>Distribuição da estatística sob a hipótese nula</h3>
<p>Em seguida fazemos a simulação com a função <code>Rsampling</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>emb.r &lt;-<span class="st"> </span><span class="kw">Rsampling</span>(<span class="dt">type =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">dataframe =</span> embauba,
+<span class="st">                    </span><span class="dt">statistics =</span> emb.ei, <span class="dt">cols =</span> <span class="dv">2</span>, <span class="dt">ntrials =</span> <span class="dv">1000</span>)</code></pre></div>
<p><strong>O que significa este comando?</strong></p>
<ul>
<li><code>type = &quot;normal&quot;</code> escolhe uma randomização de todos os elementos (mais abaixo você verá outros tipos de randomização).</li>
<li><code>dataframe = embauba</code> indica a tabela com os dados</li>
<li><code>statistics = emb.ei</code> indica a função que calcula a(s) estatística(s) de interesse da tabela de dados.</li>
<li><code>cols = 2</code> indica que a randomização deve ser feita sobre a segunda coluna da tabela de dados.</li>
<li><code>ntrials = 1000</code> indica o número de repetições da simulação.</li>
</ul>
<p>A distribuição das estatística de interesse na simulação nem incluiu o valor observado:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">hist</span>(emb.r, <span class="dt">xlim=</span><span class="kw">c</span>(-<span class="fl">0.5</span>, <span class="fl">0.5</span>),
+<span class="st">      </span><span class="dt">main =</span> <span class="st">&quot;Distribuição da estatística de interesse sob H0&quot;</span>,
+<span class="st">      </span><span class="dt">xlab =</span> <span class="st">&quot;Estatística de interesse&quot;</span>)
&gt;<span class="st"> </span><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">emb.ei</span>(embauba), <span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Distribuição das diferenças nas proporções de embaúbas brancas e vermelhas com lianas em 1000 simulações da hipótese nula de ausência de diferença nas populações amostradas. A linha vermelha indica a diferença observada." />
<p class="caption">Distribuição das diferenças nas proporções de embaúbas brancas e vermelhas com lianas em 1000 simulações da hipótese nula de ausência de diferença nas populações amostradas. A linha vermelha indica a diferença observada.</p>
</div>
</div>
<div id="decisao-rejeitamos-a-hipotese-nula" class="section level3">
<h3>Decisão: rejeitamos a hipótese nula?</h3>
<p>Seguindo o padrão das ciências biológicas, adotamos o critério de rejeitar a hipótese nula se a probabilidade da estatística de interesse sob a hipótese nula for menor que 5%.</p>
<p>Este critério é verificado com um teste lógico no R:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">sum</span>(emb.r &gt;=<span class="st"> </span><span class="kw">emb.ei</span>(embauba))/<span class="dv">1000</span> &lt;<span class="st"> </span><span class="fl">0.05</span>
[<span class="dv">1</span>] <span class="ot">TRUE</span></code></pre></div>
<p><strong>Conclusão:</strong> rejeita-se a hipótese nula (p&lt;0,05).</p>
</div>
</div>
<div id="embaralhando-dentro-de-linhas-para-testar-diferencas-dentro-de-pares" class="section level2">
<h2>Embaralhando dentro de linhas para testar diferenças dentro de pares</h2>
<p>O dataframe <code>azteca</code> tem o número de formigas <em>Azteca</em> sp recrutadas por extratos aquosos de folhas novas e velhas de embaúbas.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">head</span>(azteca)
  plant extract.new extract.old
<span class="dv">1</span>     <span class="dv">1</span>           <span class="dv">5</span>           <span class="dv">0</span>
<span class="dv">2</span>     <span class="dv">2</span>          <span class="dv">12</span>           <span class="dv">6</span>
<span class="dv">3</span>     <span class="dv">3</span>          <span class="dv">30</span>           <span class="dv">5</span>
<span class="dv">4</span>     <span class="dv">4</span>           <span class="dv">0</span>           <span class="dv">0</span>
<span class="dv">5</span>     <span class="dv">5</span>           <span class="dv">0</span>           <span class="dv">2</span>
<span class="dv">6</span>     <span class="dv">6</span>           <span class="dv">5</span>           <span class="dv">2</span>
&gt;<span class="st"> </span><span class="kw">summary</span>(azteca)
     plant     extract.new     extract.old    
 Min.   :<span class="st"> </span><span class="dv">1</span>   Min.   :<span class="st"> </span><span class="fl">0.00</span>   Min.   :<span class="st"> </span><span class="fl">0.000</span>  
 1st Qu.:<span class="st"> </span><span class="dv">6</span>   1st Qu.:<span class="st"> </span><span class="fl">2.00</span>   1st Qu.:<span class="st"> </span><span class="fl">1.000</span>  
 Median :<span class="dv">11</span>   Median :<span class="st"> </span><span class="fl">4.00</span>   Median :<span class="st"> </span><span class="fl">2.000</span>  
 Mean   :<span class="dv">11</span>   Mean   :<span class="fl">10.05</span>   Mean   :<span class="st"> </span><span class="fl">2.714</span>  
 3rd Qu.:<span class="dv">16</span>   3rd Qu.:<span class="fl">12.00</span>   3rd Qu.:<span class="st"> </span><span class="fl">4.000</span>  
 Max.   :<span class="dv">21</span>   Max.   :<span class="fl">50.00</span>   Max.   :<span class="fl">10.000</span>  </code></pre></div>
<p>Saiba mais sobre os dados em sua página de ajuda (<code>?azteca</code>).</p>
<div id="hipotese-do-estudo-1" class="section level3">
<h3>Hipótese do estudo</h3>
<p>A hipótese do estudo é que o recrutamento é mais intenso quando uma folha nova é danificada. A previsão para o experimento é que o recrutamento por extrato de folhas novas seja maior, o que ocorreu:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">splot</span>(azteca$extract.new, azteca$extract.old,
+<span class="st">            </span><span class="dt">groups.names=</span><span class="kw">c</span>(<span class="st">&quot;Folha nova&quot;</span>,<span class="st">&quot;Folha velha&quot;</span>),
+<span class="st">            </span><span class="dt">ylab=</span><span class="st">&quot;N de formigas recrutadas&quot;</span>,
+<span class="st">            </span><span class="dt">xlab=</span><span class="st">&quot;Tipo de extrato aplicado&quot;</span>)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Número de formigas recrutadas por extratos de folhas novas e velhas de embaúbas. Os extratos foram aplicados em pares de folhas próximas em embaúbas que tinham colônias de formigas. As linhas ligam folhas do mesmo par experimental." />
<p class="caption">Número de formigas recrutadas por extratos de folhas novas e velhas de embaúbas. Os extratos foram aplicados em pares de folhas próximas em embaúbas que tinham colônias de formigas. As linhas ligam folhas do mesmo par experimental.</p>
</div>
</div>
<div id="hipotese-nula-1" class="section level3">
<h3>Hipótese nula</h3>
<p>A hipótese nula é de que o recrutamento provocado pelos estratos é o mesmo. Note que para controlar outras fontes de variação o experimento foi pareado. Então para simular a hipótese nula temos que embaralhar o número de formigas recrutadas <strong>dentro</strong> de cada par de folhas.</p>
</div>
<div id="estatistica-de-interesse-1" class="section level3">
<h3>Estatística de interesse</h3>
<p>A cada simulação temos que calcular nossa <strong>estatística de interesse</strong>, que é a média da diferença das folhas de cada par. Uma função para isso:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>azt.ei &lt;-<span class="st"> </span>function(dataframe){
+<span class="st">     </span>diferencas &lt;-<span class="st"> </span><span class="kw">with</span>(dataframe, extract.new -<span class="st"> </span>extract.old)
+<span class="st">     </span><span class="kw">mean</span>(diferencas)
+<span class="st"> </span>}
&gt;<span class="st"> </span>## Valor observado
<span class="er">&gt;</span><span class="st"> </span><span class="kw">azt.ei</span>(azteca)
[<span class="dv">1</span>] <span class="fl">7.333333</span></code></pre></div>
<p>No experimento o extrato de folhas novas recrutou em média 7.3 formigas que o extrato de folha velha, em cada par.</p>
</div>
<div id="distribuicao-da-estatistica-sob-a-hipotese-nula-1" class="section level3">
<h3>Distribuição da estatística sob a hipótese nula</h3>
<p>Como os pares são linhas em nosso dataframe, simulamos a hipótese nula embaralhando os valores dentro de cada linha:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>azt.r &lt;-<span class="st"> </span><span class="kw">Rsampling</span>(<span class="dt">type =</span> <span class="st">&quot;within_rows&quot;</span>, <span class="dt">dataframe =</span> azteca,
+<span class="st">                    </span><span class="dt">statistics =</span> azt.ei, <span class="dt">cols =</span> <span class="dv">2</span>:<span class="dv">3</span>, <span class="dt">ntrials =</span> <span class="dv">1000</span>)</code></pre></div>
<p>Mudamos o argumento <code>type = &quot;within_rows&quot;</code>, para indicar que os valores devem ser embaralhados dentro das linhas. O argumento <code>cols = 2:3</code> indica as colunas do dataframe que têm as contagens.</p>
<p>Uma diferença igual ou maior que a observada foi muito rara na distribuição da estatística de interesse:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">hist</span>(azt.r,
+<span class="st">      </span><span class="dt">main =</span> <span class="st">&quot;Distribuição da estatística de interesse sob H0&quot;</span>,
+<span class="st">      </span><span class="dt">xlab =</span> <span class="st">&quot;Estatística de interesse&quot;</span>)
&gt;<span class="st"> </span><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">azt.ei</span>(azteca), <span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Distribuição das diferenças do número de formigas recrutadas por extratos de folhas novas e velhas de embaúba em pares experimentais, em 1000 simulações da hipótese nula de ausência de diferença. A linha vermelha indica a diferença observada." />
<p class="caption">Distribuição das diferenças do número de formigas recrutadas por extratos de folhas novas e velhas de embaúba em pares experimentais, em 1000 simulações da hipótese nula de ausência de diferença. A linha vermelha indica a diferença observada.</p>
</div>
</div>
<div id="decisao-rejeitamos-a-hipotese-nula-1" class="section level3">
<h3>Decisão: rejeitamos a hipótese nula?</h3>
<p>Aplicando nosso critério de significância:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">sum</span>(azt.r &gt;=<span class="st"> </span><span class="kw">azt.ei</span>(azteca))/<span class="dv">1000</span> &lt;<span class="st"> </span><span class="fl">0.05</span>
[<span class="dv">1</span>] <span class="ot">TRUE</span></code></pre></div>
<p><strong>Conclusão:</strong> rejeita-se a hipótese nula (p&lt;0,05).</p>
</div>
</div>
<div id="aleatorizacao-com-reposicao" class="section level2">
<h2>Aleatorização com reposição</h2>
<p>O dataframe <code>peucetia</code> tem os dados de um experimento de escolha de substrato por aranhas do gênero <em>Peucetia</em>. Vinte e sete aranhas foram mantidas em placas de Petri cobertas com dois substratos (folhas com e sem tricomas gladulosos). Em seis inspeções a cada placa registrou-se se cada aranha estava sobre as folhas com tricomas.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">head</span>(peucetia)
        t1    t2    t3    t4    t5    t6
[<span class="dv">1</span>,] <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span>
[<span class="dv">2</span>,] <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span>
[<span class="dv">3</span>,] <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span>
[<span class="dv">4</span>,]  <span class="ot">TRUE</span>  <span class="ot">TRUE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span>
[<span class="dv">5</span>,]  <span class="ot">TRUE</span>  <span class="ot">TRUE</span>  <span class="ot">TRUE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span>
[<span class="dv">6</span>,] <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span>  <span class="ot">TRUE</span>  <span class="ot">TRUE</span>  <span class="ot">TRUE</span></code></pre></div>
<p>Saiba mais sobre os dados em sua página de ajuda (<code>?peucetia</code>).</p>
<div id="hipotese-do-estudo-2" class="section level3">
<h3>Hipótese do estudo</h3>
<p>A hipótese do estudo é que as aranhas preferem caçar em plantas com pêlos glandulosos, onde a captura de presas é mais fácil. A previsão para o experimento é que as aranhas devem estar a maior parte do tempo nas folhas com tricomas. De fato, a maioria das aranhas esteve nas folhas com tricomas em 4 ou mais inspeções:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>## Número de inspeções em que estava em folha com tricomas
<span class="er">&gt;</span><span class="st"> </span>n.insp &lt;-<span class="st"> </span><span class="kw">apply</span>(peucetia, <span class="dv">1</span>, sum)
&gt;<span class="st"> </span><span class="kw">barplot</span>(<span class="kw">table</span>(<span class="kw">factor</span>(n.insp, <span class="dt">levels=</span><span class="dv">0</span>:<span class="dv">6</span>)),
+<span class="st">         </span><span class="dt">xlab=</span><span class="st">&quot;N de inspeções em que estava na folha com tricoma&quot;</span>,
+<span class="st">         </span><span class="dt">ylab=</span><span class="st">&quot;N de aranhas&quot;</span>)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Número de inspeções em que as 27 aranhas foram registradas em folhas com tricomas, em um experimento de preferência por substratos." />
<p class="caption">Número de inspeções em que as 27 aranhas foram registradas em folhas com tricomas, em um experimento de preferência por substratos.</p>
</div>
</div>
<div id="hipotese-nula-2" class="section level3">
<h3>Hipótese nula</h3>
<p>A hipótese nula é de que não há preferência. Como metade das placas estavam cobertas com cada tipo de folha, a expectativa nula é que as aranhas estivessem na área coberta por folhas com tricomas em metade das inspeções, em média. Esta expectativa tem a premissa que cada inspeção é um evento independente.</p>
</div>
<div id="estatistica-de-interesse-2" class="section level3">
<h3>Estatística de interesse</h3>
<p>A cada simulação temos que calcular nossa <strong>estatística de interesse</strong>, que é a média do número de inspeções em que as aranhas estavam sobre folhas com tricomas. Uma função para isso:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>peu.ei &lt;-<span class="st"> </span>function(dataframe){
+<span class="st">     </span><span class="kw">mean</span>(<span class="kw">apply</span>(dataframe, <span class="dv">1</span>, sum))
+<span class="st"> </span>}
&gt;<span class="st"> </span>## Valor observado
<span class="er">&gt;</span><span class="st"> </span><span class="kw">peu.ei</span>(peucetia)
[<span class="dv">1</span>] <span class="fl">4.555556</span></code></pre></div>
<p>As aranhas foram registradas em média <code>r round(peu.ei(peucetia),2)</code> das 6 inspeções na área coberta por folhas com tricomas.</p>
</div>
<div id="distribuicao-da-estatistica-sob-a-hipotese-nula-2" class="section level3">
<h3>Distribuição da estatística sob a hipótese nula</h3>
<p>Para simular nossa hipótese nula criamos um <em>data frame</em> com a mesma estrutura, em que cada aranha esteja metade das inspeções nas folhas com tricomas</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>peu.H0 &lt;-<span class="st"> </span><span class="kw">matrix</span>( <span class="kw">rep</span>(<span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">FALSE</span>), <span class="dt">each =</span> <span class="dv">3</span>),
+<span class="st">                  </span><span class="dt">nrow =</span> <span class="kw">nrow</span>(peucetia), <span class="dt">ncol =</span> <span class="kw">ncol</span>(peucetia), <span class="dt">byrow=</span><span class="ot">TRUE</span>)
&gt;<span class="st"> </span>## Converte em data.frame
<span class="er">&gt;</span><span class="st"> </span>peu.H0 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(peu.H0)
&gt;<span class="st"> </span>## verificando
<span class="er">&gt;</span><span class="st"> </span><span class="kw">head</span>(peu.H0)
    X1   X2   X3    X4    X5    X6
<span class="dv">1</span> <span class="ot">TRUE</span> <span class="ot">TRUE</span> <span class="ot">TRUE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span>
<span class="dv">2</span> <span class="ot">TRUE</span> <span class="ot">TRUE</span> <span class="ot">TRUE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span>
<span class="dv">3</span> <span class="ot">TRUE</span> <span class="ot">TRUE</span> <span class="ot">TRUE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span>
<span class="dv">4</span> <span class="ot">TRUE</span> <span class="ot">TRUE</span> <span class="ot">TRUE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span>
<span class="dv">5</span> <span class="ot">TRUE</span> <span class="ot">TRUE</span> <span class="ot">TRUE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span>
<span class="dv">6</span> <span class="ot">TRUE</span> <span class="ot">TRUE</span> <span class="ot">TRUE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span></code></pre></div>
<p>E agora simulamos a hipótese nula amostrando com reposição cada linha <a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>peu.r &lt;-<span class="st"> </span><span class="kw">Rsampling</span>(<span class="dt">type =</span> <span class="st">&quot;within_rows&quot;</span>, <span class="dt">dataframe =</span> peu.H0,
+<span class="st">                    </span><span class="dt">statistics =</span> peu.ei, <span class="dt">ntrials =</span> <span class="dv">1000</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>)</code></pre></div>
<p>O argumento <code>replace = TRUE</code>, indica amostragem com reposição. No caso isso equivale a sortear uma posição independente para cada aranha a cada inspeção. A probabilidade da aranha estar na folha com tricomas é 0,5 a cada sorteio.</p>
<p>Uma média igual ou maior que a observada não ocorreu na distribuição da estatística de interesse simulada:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">hist</span>(peu.r,
+<span class="st">      </span><span class="dt">main =</span> <span class="st">&quot;Distribuição da estatística de interesse sob H0&quot;</span>,
+<span class="st">      </span><span class="dt">xlab =</span> <span class="st">&quot;Estatística de interesse&quot;</span>, <span class="dt">xlim =</span> <span class="kw">range</span>(peu.r, <span class="kw">peu.ei</span>(peucetia)))
&gt;<span class="st"> </span><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">peu.ei</span>(peucetia), <span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Distribuição do número médio de inspeções em que as aranhas estavam em folhas com tricomas, em 1000 simulações da hipótese nula de ausência de preferência por substrato. A linha vermelha indica a média observada." />
<p class="caption">Distribuição do número médio de inspeções em que as aranhas estavam em folhas com tricomas, em 1000 simulações da hipótese nula de ausência de preferência por substrato. A linha vermelha indica a média observada.</p>
</div>
</div>
<div id="decisao-rejeitamos-a-hipotese-nula-2" class="section level3">
<h3>Decisão: rejeitamos a hipótese nula?</h3>
<p>Aplicando nosso critério de significância:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">sum</span>(peu.r &gt;=<span class="st"> </span><span class="kw">peu.ei</span>(peucetia))/<span class="dv">1000</span> &lt;<span class="st"> </span><span class="fl">0.05</span>
[<span class="dv">1</span>] <span class="ot">TRUE</span></code></pre></div>
<p><strong>Conclusão:</strong> rejeita-se a hipótese nula (p&lt;0,05).</p>
</div>
</div>
<div id="uma-hipotese-nula-mais-realista" class="section level2">
<h2>Uma hipótese nula mais realista?</h2>
<p>No exemplo anterior simulamos a hipótese nula sorteando uma posição para cada aranha a cada inspeção. A premissa é que a posição da aranha em uma inspeção não afeta sua posição nas outras, ou seja, que as inspeções são eventos independentes.</p>
<p>Mas e se há uma correlação temporal na posição das aranhas? Isso pode acontecer com aranhas que se movem a uma frequência menor que o intervalo entre as inspeções. Se isso é verdade, registros seguidos em um tipo de folha podem indicar apenas tendência a ficar no mesmo lugar, e não preferência. Nesse caso a hipótese nula deve manter o número de inspeções em cada tipo de folha, alterando apenas o tipo.</p>
<div id="hipotese-nula-3" class="section level3">
<h3>Hipótese nula</h3>
<p>A proporção das inspeções em que as aranhas permanecem em um dos substratos não depende do tipo de substrato (folha com ou sem tricomas).</p>
<p>Portanto a hipótese nula é sobre a independência entre número de inspeções e tipo de substrato. Simulamos este cenário embaralhando número de ocasiões entre substratos, para cada aranha. Para isso vamos criar um <em>data frame</em> com número de inspeções em cada substrato:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>## N de inspeções em folha com tricoma
<span class="er">&gt;</span><span class="st"> </span>tric &lt;-<span class="st"> </span><span class="kw">apply</span>(peucetia, <span class="dv">1</span>, sum)
&gt;<span class="st"> </span>## N de inspeções em folha lisa
<span class="er">&gt;</span><span class="st"> </span>lisa &lt;-<span class="st"> </span><span class="kw">apply</span>(peucetia, <span class="dv">1</span>, function(x) <span class="kw">sum</span>(x==<span class="dv">0</span>))
&gt;<span class="st"> </span>## Monta o data frame
<span class="er">&gt;</span><span class="st"> </span>peu.H0b &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">tric=</span>tric, <span class="dt">lisa =</span> lisa)
&gt;<span class="st"> </span>## Primeiras linhas
<span class="er">&gt;</span><span class="st"> </span><span class="kw">head</span>(peu.H0b)
  tric lisa
<span class="dv">1</span>    <span class="dv">0</span>    <span class="dv">6</span>
<span class="dv">2</span>    <span class="dv">0</span>    <span class="dv">6</span>
<span class="dv">3</span>    <span class="dv">0</span>    <span class="dv">6</span>
<span class="dv">4</span>    <span class="dv">2</span>    <span class="dv">4</span>
<span class="dv">5</span>    <span class="dv">3</span>    <span class="dv">3</span>
<span class="dv">6</span>    <span class="dv">3</span>    <span class="dv">3</span></code></pre></div>
</div>
<div id="estatistica-de-interesse-3" class="section level3">
<h3>Estatística de interesse</h3>
<p>Uma mesma estatística de interesse pode ser aplicada a diferentes hipóteses nulas. Então mantemos a mesma do exemplo anterior: média do número de inspeções em que as aranhas foram registradas nas folhas com tricomas.</p>
<p>Mas como a o <em>data frame</em> que será aleatorizado mudou, criamos uma nova função no R para calcular a estatística de interesse</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>peu.ei2 &lt;-<span class="st"> </span>function(dataframe) <span class="kw">mean</span>(dataframe$tric)
&gt;<span class="st"> </span>## Verificando
<span class="er">&gt;</span><span class="st"> </span><span class="kw">peu.ei2</span>(peu.H0b)
[<span class="dv">1</span>] <span class="fl">4.555556</span></code></pre></div>
</div>
<div id="distribuicao-da-estatistica-de-interesse-sob-a-hipotese-nula" class="section level3">
<h3>Distribuição da estatística de interesse sob a hipótese nula</h3>
<p>Simulamos a hipótese nula embaralhando as linhas do <em>data frame</em> com número de inspeções por substrato:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>peu.r2 &lt;-<span class="st"> </span><span class="kw">Rsampling</span>(<span class="dt">type =</span> <span class="st">&quot;within_rows&quot;</span>, <span class="dt">dataframe =</span> peu.H0b,
+<span class="st">                    </span><span class="dt">statistics =</span> peu.ei2, <span class="dt">ntrials =</span> <span class="dv">1000</span>)</code></pre></div>
<p>A distribuição nula mudou bastante de forma comparada com a seção anterior. Mas uma média igual ou maior que a observada ainda foi muito rara:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">hist</span>(peu.r2,
+<span class="st">      </span><span class="dt">main =</span> <span class="st">&quot;Distribuição da estatística de interesse sob H0&quot;</span>,
+<span class="st">      </span><span class="dt">xlab =</span> <span class="st">&quot;Estatística de interesse&quot;</span>, <span class="dt">xlim =</span> <span class="kw">range</span>(peu.r, <span class="kw">peu.ei</span>(peucetia)))
&gt;<span class="st"> </span><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">peu.ei</span>(peucetia), <span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Distribuição do número médio de inspeções em que as aranhas estavam em folhas com tricomas, em 1000 simulações da hipótese nula de ausência de preferência por substrato, considerando tendência das aranhas permanecerem onde estão. A linha vermelha indica a média observada." />
<p class="caption">Distribuição do número médio de inspeções em que as aranhas estavam em folhas com tricomas, em 1000 simulações da hipótese nula de ausência de preferência por substrato, considerando tendência das aranhas permanecerem onde estão. A linha vermelha indica a média observada.</p>
</div>
</div>
<div id="decisao-rejeitamos-a-hipotese-nula-3" class="section level3">
<h3>Decisão: rejeitamos a hipótese nula?</h3>
<p>Aplicando nosso critério de significância:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">sum</span>(peu.r2 &gt;=<span class="st"> </span><span class="kw">peu.ei</span>(peucetia))/<span class="dv">1000</span> &lt;<span class="st"> </span><span class="fl">0.05</span>
[<span class="dv">1</span>] <span class="ot">TRUE</span></code></pre></div>
<p><strong>Conclusão:</strong> rejeita-se a hipótese nula (p&lt;0,05).</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Statistics.com LCC. 2009. Resampling Stats Add-in for Excel User’s Guide. <a href="http://www.resample.com/content/software/excel/userguide/RSXLHelp.pdf" class="uri">http://www.resample.com/content/software/excel/userguide/RSXLHelp.pdf</a><a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Há maneiras mais otimizadas de fazer isso, mas esta reproduz a lógica de sorteios de uma urna do <em>Resampling Stats</em><a href="#fnref2">↩</a></p></li>
</ol>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
